<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0055)http://www.asahi-net.or.jp/~kv8s-yjm/another/yja110.htm -->
<HTML><HEAD><TITLE>C++でCOMクライアント</TITLE>
<META http-equiv=Content-Type content="text/html; charset=shift_jis">
<META content="MSHTML 6.00.2900.2769" name=GENERATOR></HEAD>
<BODY vLink=#800080 link=#0000ff bgColor=#c0c0c0><!-- 表題 -->
<TABLE width=740>
  <TBODY>
  <TR align=middle>
    <TD><FONT color=#408040 size=5>C++でCOMクライアント　１０/１０</FONT><BR><FONT 
      color=#408040 size=4>〜 <STRONG>10. まとめとサンプル</STRONG> 〜</FONT> 
  </TD></TR></TBODY></TABLE><!-- ショートカット -->
<TABLE width=740>
  <TBODY>
  <TR>
    <TD align=right><FONT color=#800000 
      size=2>★このコーナーの無断転載、無断配布を禁止いたします。★</FONT> </TD></TR></TBODY></TABLE>
<TABLE width=740>
  <TBODY>
  <TR>
    <TD vAlign=top><FONT size=2><A 
      href="http://www.asahi-net.or.jp/~kv8s-yjm/another/yjamain.htm">表紙へ戻る</A>　　<A 
      href="http://www.asahi-net.or.jp/~kv8s-yjm/another/yja101.htm">目次へ戻る</A>　　<A 
      href="http://www.asahi-net.or.jp/~kv8s-yjm/another/yja109.htm">[前頁]</A>　　<FONT 
      color=#606060>[次頁]</FONT><BR></FONT><BR><FONT 
      size=3><B>[まとめとサンプル]</B></FONT><BR><BR><FONT 
      size=2>　今回は、あえてスマートポインタやATLを使わずに COMクライアントをつくり、 
      C++とCOMクライアントの関連性を実感してもらいました。<BR>　C++でCOMを扱うときは、Coで始まる <B>COM 
      API</B>を呼び出すほか、 COMインターフェイスは C++ の <B>class</B> と 
      <B>virtual関数</B>を使うことが分かったと思います。<BR>　また Visual 
      C++では、「<B>#import</B>」ディレクティブというのがあり、簡単に CLSIDやIID、および 
      COMインターフェイスを定義したヘッダーファイルが生成できることが分かりました。 
      <BR><BR>　以下に今回の手順をまとめておきます。<BR><BR>　・CLSID、IIDを定義する <A 
      href="http://www.asahi-net.or.jp/~kv8s-yjm/another/yja104.htm">４</A><BR>　　→ 
      objbase.h をインクルードする<BR>　　→ #importディレクティブを使って、CLSIDとIIDの定義を自動生成<BR>　　　 
      CLSIDは、CLSID_クラス名となり、IIDは、IID_インターフェイス名として自動定義<BR><BR>　・インターフェイスを定義する <A 
      href="http://www.asahi-net.or.jp/~kv8s-yjm/another/yja105.htm">５</A><BR>　　→ 
      #importディレクティブを使って、classとvirtual関数を用いた定義を自動生成<BR>　　　 インターフェイス名を持つ 
      C++クラスが自動定義<BR><BR>　・スレッド単位の初期処理、終了処理を追加する <A 
      href="http://www.asahi-net.or.jp/~kv8s-yjm/another/yja106.htm">６</A><BR>　　→ 
      CoInitialize, CoUninitializeの呼び出し<BR><BR>　・インスタンスを作成する <A 
      href="http://www.asahi-net.or.jp/~kv8s-yjm/another/yja107.htm">７</A><BR>　　→ 
      インスタンスへのアクセスのため、インターフェイスポインタ変数を宣言<BR>　　→ 
      CoCreateInstanceの呼び出し<BR><BR>　・メソッドを呼び出す <A 
      href="http://www.asahi-net.or.jp/~kv8s-yjm/another/yja108.htm">８</A><BR>　　→ 
      C++クラスへのポインタは、COMインターフェイスポインタに相当<BR>　　→ メソッドは、C++クラスの 
      virtual関数<BR><BR>　・インスタンスの解放 <A 
      href="http://www.asahi-net.or.jp/~kv8s-yjm/another/yja109.htm">９</A><BR>　　→ 
      Releaseメソッドを呼び出す<BR><BR><B>※サンプル</B><BR>　ここに、今回説明に利用したサンプルプログラムを添付します。COMプログラミングの参考にご利用ください。<BR>　ダウンロード後、解凍して、まずは同梱の 
      ReadMe.txt をお読みください。<BR>　　<A 
      href="http://www.asahi-net.or.jp/~kv8s-yjm/another/lib1/project1.lzh">VB版COMコンポーネント(project1.lzh)</A> 
      Visual Basic 6.0対応の ActiveX DLLプロジェクトです。<BR>　　<A 
      href="http://www.asahi-net.or.jp/~kv8s-yjm/another/lib1/simpleclientcpp.lzh">C++版COMクライアント(simpleclientcpp.lzh)</A> 
      Visual C++ 6.0対応の Win32 Console 
  Applicationプロジェクトです。<BR><BR></FONT></TD></TR></TBODY></TABLE><!-- ショートカット -->
<TABLE width=740>
  <TBODY>
  <TR>
    <TD align=left><FONT size=2><A 
      href="http://www.asahi-net.or.jp/~kv8s-yjm/another/yjamain.htm">表紙へ戻る</A>　　<A 
      href="http://www.asahi-net.or.jp/~kv8s-yjm/another/yja101.htm">目次へ戻る</A>　　<A 
      href="http://www.asahi-net.or.jp/~kv8s-yjm/another/yja109.htm">[前頁]</A>　　<FONT 
      color=#606060>[次頁]</FONT><BR></FONT></TD></TR></TBODY></TABLE>
<HR>
<LEFT><FONT color=#800000 size=2>★このコーナーの無断転載、無断配布を禁止いたします。★</FONT></LEFT> <!-- Normal Footer --><LEFT><FONT size=2><BR>Copyright(C) Yajima,Satoshi (<A 
href="mailto:kv8s-yjm@asahi-net.or.jp">kv8s-yjm@asahi-net.or.jp</A>) 
</FONT></LEFT></BODY></HTML>
